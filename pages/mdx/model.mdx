---
name: Modelling
description: TBD
slug: /model
---

import "katex/dist/katex.min.css";

# Modelling

<br />

Note: $(r,\theta , \phi)$ centred on $(0,0,f)$

<br />

For an incident beam with intensity distribution $I_0(\theta )$ along $\hat{z}$ axis, a paraboloid reflector: $z^2 = K(x^2+y^2)$ which has focal point at (0,0,f):

<br />

Near focus:

```math
\bar{E}(r_0,\theta_0 ,\phi_0 ) = \frac{1}{2\pi i} \int_0^{2 \pi } \int_0^{\theta_{max}} \hat{a} (\theta , \phi) I_0(\theta) q(\theta) e^{-i K \bar{s}_0 \cdot \bar{r}_0} sin(\theta) \; {d\theta} \; {d\phi}

```

- $\hat{a} (\theta , \phi)$ is the polarization direction
- $\hat{s} (\theta , \phi)$ is the unit vector in the direction of propagation
- $\bar{r}_0$ is the position vector of point of measurement (point ($r_0, \theta_0 , \phi_0$))
- $q(\theta)$ is the apodization factor of a paraboloid

<br />

Note: $P$ depends on $\theta$ as $P(\theta) = f \, tan \theta - K \, P(\theta)^2 \, tan \theta = 2f \, \left(\frac{sec \theta - 1}{tan \theta}\right) = 2f \, tan\left(\frac{\theta}{2}\right)$

The focal sphere is a sphere centred on $(0,0,f)$ with radius $f$. Consider an infinitesimally thin annulus of radius $R$ taken from the incident beam. All of this light is focused into a strip on the focal sphere. The apodization factor, $q(\theta)$, ensures conservation of energy since it is defined as the ratio $\sqrt{\frac{dS_i}{dS_s}}$ where $dS_i$ is an infinitesimal area of the incident beam (annulus) and $dS_s$ is the corresponding area on the focal sphere.

<br />

```math
dS_i = 2 \pi R \; dR
```

```math
R = P(\theta) = 2f \, tan\left(\frac{\theta}{2}\right)
```

```math
dR = f \, sec^2\left(\frac{\theta}{2}\right) \; d\theta
```

```math
dS_i = 4 \pi f^2 \, tan\left(\frac{\theta}{2}\right) \, sec^2\left(\frac{\theta}{2}\right) \; d\theta
```

```math
dS_s = (2 \pi f) (sin \theta) (f \, d\theta) = 2 \pi f^2 \, sin \theta  \; d\theta
```

```math
q(\theta) = \sqrt{\frac{dS_i}{dS_s}} = \sqrt{\frac{4 \pi f^2 \, tan\left(\frac{\theta}{2}\right) sec^2\left(\frac{\theta}{2}\right) \; d\theta}{2 \pi f^2 \, sin \theta \; d\theta}} = \sqrt{\frac{2 tan\left(\frac{\theta}{2}\right) sec^2\left(\frac{\theta}{2}\right) }{2 sin\left(\frac{\theta}{2}\right) cos\left(\frac{\theta}{2}\right)}} = sec^2\left(\frac{\theta}{2}\right)
```

By convention:

```math
\bar{r}_0 = r_0 \begin{pmatrix} sin\theta_0 \, cos\phi_0 \\ sin\theta_0 \, sin\phi_0 \\ cos\theta_0\end{pmatrix}
```

For incident rays parallel to $\hat{z}$:

```math
\bar{s} = \begin{pmatrix} sin\theta \, cos\phi \\ sin\theta \, sin\phi \\ cos\theta\end{pmatrix}
```

<br />

```math
e^{-iK\bar{s}\cdot\bar{r}_0} = e^{-i K r_0 (sin\theta \, sin\theta_0 \, [cos\phi\, cos\phi_0\, + sin\phi\, sin\phi_0] + cos\theta\, cos\theta_0)}\\ = e^{-iK(sin\theta\, sin\theta_0\,cos(\phi-\phi_0)+cos\theta\,cos\theta_0)}
```

- Before reflection, $\hat{a}_0 = \begin{pmatrix} cos\phi \\ sin\phi \\ 0 \end{pmatrix}$
- After reflection, $\hat{a}(\theta,\phi) = \begin{pmatrix} cos\theta\, cos\phi \\ cos\theta\, sin\phi \\ sin\theta \end{pmatrix}$

Therefore:

```math
\bar{E}(r_0, \theta_0,\phi_0) = \frac{Kf}{2\pi i}\int_0^{2\pi} \int_0^{\theta_{max}}I_0(\theta)sec^2\left(\frac{\theta}{2}\right)sin\theta e^{-iKr_0[sin\theta sin\theta_0 cos(\phi - \phi_0) + cos\theta cos\theta_0]} \hat{a}(\theta,\phi) \; d\theta \; d\phi
```

Note the following identities for the $n^{th}$ bessel function of the first kind: $J_n(x)$

```math
\int_0^{2\pi} cos(n\varphi)e^{ixcos(\varphi-\varepsilon)}d\varphi = 2\pi i^n J_n(x) cos(n\varphi)
```

<br />

```math
\int_0^{2\pi} sin(n\varphi)e^{ixcos(\varphi-\varepsilon)}d\varphi = 2\pi i^n J_n(x) sin(n\varphi)
```

Thus:

```math
\bar{E}(r_0,\theta_0,\phi_0) = \frac{Kf}{2\pi i} \int_0^{\theta_{max}} I_0(\theta) sin\theta \, sec^2\left(\frac{\theta}{2}\right)e^{-iKr_0 cos\theta_0 cos\theta} cos\theta \int_0^{2\pi} \begin{pmatrix} cos\phi \\ sin\phi \\ tan\theta \end{pmatrix} e^{-iKr_0(sin\theta_0sin\theta cos(\phi-\phi_0))}d\phi \; d\theta \\ = Kf \int_0^{\theta_{max}} I_0(\theta) sin\theta \, sec^2\left(\frac{\theta}{2}\right)e^{-iKr_0 cos\theta_0 cos\theta} \begin{pmatrix} J_1(Kr_0sin\theta_0sin\theta)cos\phi_0 \\ J_1(Kr_0sin\theta_0sin\theta)sin\phi_0 \\ -i J_0(Kr_0sin\theta_0sin\theta)tan\theta \end{pmatrix} d\theta
```

Represented in cylindrical coordinates:

```math
E_z(r_0,\theta_0,\phi_0) = \bar{E} \cdot \hat{z} = -iKf \int_0^{\theta_{max}} I_0(\theta)sec^2\left(\frac{\theta}{2}\right) sin^2\theta e^{-iKr_0 cos\theta_0 cos\theta} J_0(Kr_0sin\theta_0sin\theta) \; d\theta
```

<br />

```math
E_r(r_0,\theta_0,\phi_0) = \bar{E} \cdot \hat{r} = \bar{E} \cdot \begin{pmatrix} cos\phi_0 \\ sin\phi_0 \\ 0 \end{pmatrix}
```

<br />

```math
= \frac{Kf}{2} \int_0^{\theta_{max}} I_0(\theta) sec^2\left(\frac{\theta}{2}\right) sin(2\theta) e^{-iKr_0 cos\theta_0 cos\theta} J_1(Kr_0sin\theta_0 sin\theta) \; d\theta
```

<br />

```math
E_{\phi}(r_0,\theta_0,\phi_0) = \bar{E} \cdot \hat{\phi} = \bar{E} \cdot \begin{pmatrix} -sin\phi_0 \\ cos\phi_0 \\ 0 \end{pmatrix} = 0
```

For an angle of incidence $\alpha \neq 0$:

Change of coordinates:

```math
r_0 \mapsto r_0'(r_0,\theta,\phi_0)
```

<br />

```math
\phi_0 \mapsto \phi_0'(r_0,\theta,\phi_0)
```

Such that the integrals for $\bar{E}$ take the same form.
Additional phase factor: $e^{-iK\zeta(\theta,\phi,\alpha)} = e^{-iK(2f\,tan\left(\frac{\theta}{2}\right)\, \alpha \, cos\phi)}$

Therefore we require an aberration function, $\zeta(\theta,\phi,\alpha)$. Thus the exponential term is now:

```math
e^{-iK(sin\theta(f\alpha \frac{tan\left(\frac{\theta}{2}\right)cos\phi}{sin\theta} - r_0 cos\phi_0 cos_\phi - r_0 sin\phi_0 sin\phi)sin\theta_0 + r_0 cos\theta_0 cos\theta)}
```

<br />

```math
= e^{-iK[r_0'(sin\theta sin\theta_0 cos(\phi - \phi_0'))+r_0 cos\theta_0 cos\theta]}
```

Recall $a\,cos\phi + b\,sin\phi = \sqrt{a^2 + b^2} \; cos\left(\phi - tan^{-1}\left(\frac{b}{a}\right)\right)$

Substituting in values for $a$ and $b$:

```math
a = \frac{f\,\alpha\,tan\left(\frac{\theta}{2}\right)}{sin\theta} - r_0 cos\phi_0
```

<br />

```math
b = -r_0 sin\phi_0
```

<br />

```math
r_0' = \sqrt{a^2 + b^2} = \sqrt{\frac{f^2 \alpha^2 tan^2}{sin^2(\theta)}+r_0^2 - 2f\alpha r_0 cos\phi_0 \frac{tan\left(\frac{\theta}{2}\right)}{sin\theta}}
```

<br />

```math
tan(\phi_0') = \frac{r_0 sin\phi_0}{r_0 cos\phi_0 - \frac{f \alpha tan\left(\frac{\theta}{2}\right)}{sin\theta}}
```

<br />

```math
sin(\phi_0') = \frac{r_0 sin\phi_0}{r_0'}
```

<br />

```math
cos(\phi_0') = \frac{(r_0 cos\phi_0 - \frac{f \alpha tan\left(\frac{\theta}{2}\right)}{sin\theta})}{r_0'}
```

As before, using the new coordinates:

```math
\bar{E} = Kf \int_0^{\theta_{max}} I_0(\theta) sin\theta \, sec^2\left(\frac{\theta}{2}\right) cos\theta e^{-iK r_0' cos\theta_0 cos\theta} \begin{pmatrix} J_1(Kr_0' sin\theta_0 sin\theta)cos\phi_0' \\ J_1(Kr_0' sin\theta_0sin\theta)sin\phi_0' \\ -i J_0(Kr_0' sin\theta_0sin\theta)tan\theta \end{pmatrix} d\theta
```

We take the intensity distribution, $I_0(\theta)$, to be:

```math
I_0(\theta) = Ne^{-\left(\frac{r(\theta)}{w_0}\right)^2} J_1\left(\frac{2r(\theta)}{w_0}\right)
```
